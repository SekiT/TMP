(function(){"use strict";class ae extends Map{set(e,n){return super.set(e,n),n}}class G extends WeakMap{set(e,n){return super.set(e,n),n}}/*! (c) Andrea Giammarchi - ISC */const ce=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,le=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/?)>/g,de=/([^\s\\>"'=]+)\s*=\s*(['"]?)\x01/g,pe=/[\x01\x02]/g;var ue=(t,e,n)=>{let r=0;return t.join("").trim().replace(le,(i,o,s,l)=>{let a=o+s.replace(de,"=$2$1").trimEnd();return l.length&&(a+=n||ce.test(o)?" /":"></"+o),"<"+a+">"}).replace(pe,i=>i===""?"<!--"+e+r+++"-->":e+r++)};const $e=1,bt=111,me=({firstChild:t,lastChild:e})=>{const n=document.createRange();return n.setStartAfter(t),n.setEndAfter(e),n.deleteContents(),t},be=(t,e)=>t.nodeType===bt?1/e<0?e?me(t):t.lastChild:e?t.valueOf():t.firstChild:t,fe=t=>{const{firstChild:e,lastChild:n}=t;if(e===n)return n||t;const{childNodes:r}=t,i=[...r];return{ELEMENT_NODE:$e,nodeType:bt,firstChild:e,lastChild:n,valueOf(){return r.length!==i.length&&t.append(...i),t}}},{isArray:ge}=Array,he=t=>e=>{for(const n in e){const r=n==="role"?n:`aria-${n}`,i=e[n];i==null?t.removeAttribute(r):t.setAttribute(r,i)}},X=t=>t==null?t:t.valueOf(),ye=(t,e)=>{let n,r=!0;const i=document.createAttributeNS(null,e);return o=>{const s=X(o);n!==s&&((n=s)==null?r||(t.removeAttributeNode(i),r=!0):(i.value=s,r&&(t.setAttributeNodeNS(i),r=!1)))}},ve=(t,e,n)=>r=>{const i=!!X(r);n!==i&&((n=i)?t.setAttribute(e,""):t.removeAttribute(e))},xe=({dataset:t})=>e=>{for(const n in e){const r=e[n];r==null?delete t[n]:t[n]=r}},ft=(t,e)=>{let n,r,i=e.slice(2);return!(e in t)&&(r=e.toLowerCase())in t&&(i=r.slice(2)),o=>{const s=ge(o)?o:[o,!1];n!==s[0]&&(n&&t.removeEventListener(i,n,s[1]),(n=s[0])&&t.addEventListener(i,n,s[1]))}},we=t=>{let e;return n=>{e!==n&&(e=n,typeof n=="function"?n(t):n.current=t)}},Se=(t,e)=>e==="dataset"?xe(t):n=>{t[e]=n},Ae=t=>{let e;return n=>{const r=X(n);e!=r&&(e=r,t.textContent=r??"")}};var Oe=(t,e,n,r,i)=>{const o=n.length;let s=e.length,l=o,a=0,c=0,p=null;for(;a<s||c<l;)if(s===a){const $=l<o?c?r(n[c-1],-0).nextSibling:r(n[l-c],0):i;for(;c<l;)t.insertBefore(r(n[c++],1),$)}else if(l===c)for(;a<s;)(!p||!p.has(e[a]))&&t.removeChild(r(e[a],-1)),a++;else if(e[a]===n[c])a++,c++;else if(e[s-1]===n[l-1])s--,l--;else if(e[a]===n[l-1]&&n[c]===e[s-1]){const $=r(e[--s],-1).nextSibling;t.insertBefore(r(n[c++],1),r(e[a++],-1).nextSibling),t.insertBefore(r(n[--l],1),$),e[s]=n[l]}else{if(!p){p=new Map;let $=c;for(;$<l;)p.set(n[$],$++)}if(p.has(e[a])){const $=p.get(e[a]);if(c<$&&$<l){let $t=a,mt=1;for(;++$t<s&&$t<l&&p.get(e[$t])===$+mt;)mt++;if(mt>$-c){const Br=r(e[a],0);for(;c<$;)t.insertBefore(r(n[c++],1),Br)}else t.replaceChild(r(n[c++],1),r(e[a++],-1))}else a++}else t.removeChild(r(e[a++],-1))}return n};const{isArray:gt,prototype:Te}=Array,{indexOf:Ee}=Te,{createDocumentFragment:Me,createElement:Ie,createElementNS:je,createTextNode:Pe,createTreeWalker:Ce,importNode:Ne}=new Proxy({},{get:(t,e)=>document[e].bind(document)}),Re=t=>{const e=Ie("template");return e.innerHTML=t,e.content};let L;const ke=t=>{L||(L=je("http://www.w3.org/2000/svg","svg")),L.innerHTML=t;const e=Me();return e.append(...L.childNodes),e},Le=(t,e)=>e?ke(t):Re(t),ze=({childNodes:t},e)=>t[e],A=(t,e,n)=>Oe(t.parentNode,e,n,be,t),We=t=>{let e,n,r=[];const i=o=>{switch(typeof o){case"string":case"number":case"boolean":e!==o&&(e=o,n||(n=Pe("")),n.data=o,r=A(t,r,[n]));break;case"object":case"undefined":if(o==null){e!=o&&(e=o,r=A(t,r,[]));break}if(gt(o)){e=o,o.length===0?r=A(t,r,[]):typeof o[0]=="object"?r=A(t,r,o):i(String(o));break}if(e!==o)if("ELEMENT_NODE"in o)e=o,r=A(t,r,o.nodeType===11?[...o.childNodes]:[o]);else{const s=o.valueOf();s!==o&&i(s)}break;case"function":i(o(t));break}};return i},_e=(t,e)=>{switch(e[0]){case"?":return ve(t,e.slice(1),!1);case".":return Se(t,e.slice(1));case"@":return ft(t,"on"+e.slice(1));case"o":if(e[1]==="n")return ft(t,e)}switch(e){case"ref":return we(t);case"aria":return he(t)}return ye(t,e)};function Ue(t){const{type:e,path:n}=t,r=n.reduceRight(ze,this);return e==="node"?We(r):e==="attr"?_e(r,t.name):Ae(r)}const Z=t=>{const e=[];let{parentNode:n}=t;for(;n;)e.push(Ee.call(n.childNodes,t)),t=n,{parentNode:n}=t;return e},O="is\xB5",ht=new G,De=/^(?:textarea|script|style|title|plaintext|xmp)$/,T=()=>({stack:[],entry:null,wire:null}),He=(t,e)=>{const{content:n,updates:r}=Be(t,e);return{type:t,template:e,content:n,updates:r,wire:null}},Fe=(t,e)=>{const n=t==="svg",r=ue(e,O,n),i=Le(r,n),o=Ce(i,129),s=[],l=e.length-1;let a=0,c=`${O}${a}`;for(;a<l;){const p=o.nextNode();if(!p)throw`bad template: ${r}`;if(p.nodeType===8)p.data===c&&(s.push({type:"node",path:Z(p)}),c=`${O}${++a}`);else{for(;p.hasAttribute(c);)s.push({type:"attr",path:Z(p),name:p.getAttribute(c)}),p.removeAttribute(c),c=`${O}${++a}`;De.test(p.localName)&&p.textContent.trim()===`<!--${c}-->`&&(p.textContent="",s.push({type:"text",path:Z(p)}),c=`${O}${++a}`)}}return{content:i,nodes:s}},Be=(t,e)=>{const{content:n,nodes:r}=ht.get(e)||ht.set(e,Fe(t,e)),i=Ne(n,!0),o=r.map(Ue,i);return{content:i,updates:o}},z=(t,{type:e,template:n,values:r})=>{const i=yt(t,r);let{entry:o}=t;(!o||o.template!==n||o.type!==e)&&(t.entry=o=He(e,n));const{content:s,updates:l,wire:a}=o;for(let c=0;c<i;c++)l[c](r[c]);return a||(o.wire=fe(s))},yt=({stack:t},e)=>{const{length:n}=e;for(let r=0;r<n;r++){const i=e[r];i instanceof W?e[r]=z(t[r]||(t[r]=T()),i):gt(i)?yt(t[r]||(t[r]=T()),i):t[r]=null}return n<t.length&&t.splice(n),n};class W{constructor(e,n,r){this.type=e,this.template=n,this.values=r}}const vt=t=>{const e=new G,n=r=>(i,...o)=>z(r,{type:t,template:i,values:o});return Object.assign((r,...i)=>new W(t,r,i),{for(r,i){const o=e.get(r)||e.set(r,new ae);return o.get(i)||o.set(i,n(T()))},node:(r,...i)=>z(T(),new W(t,r,i)).valueOf()})},xt=new G,qe=(t,e)=>{const n=typeof e=="function"?e():e,r=xt.get(t)||xt.set(t,T()),i=n instanceof W?z(r,n):n;return i!==r.wire&&(r.wire=i,t.replaceChildren(i.valueOf())),t},Ge=vt("html");vt("svg");var f={uhtml:{render:qe,html:Ge},globals:{now:Date.now,window,setTimeout,random:Math.random,DocumentFragment}};const{now:wt,setTimeout:Xe}=f.globals,St=1e3/60,At=(t,e)=>{const n=wt(),r=t();Xe(()=>{const i=wt()<n+St?e+1:Math.max(e-1,1);At(r,i)},e)},Ot=32,E=32,Ze=.2,J=.06666666666666667,Tt=1/15,Et=45,K=30;var Q=t=>{let e=t;const n=new Map;return{next:r=>{e=r(e),n.forEach(i=>i(e))},subscribe:r=>{r(e);const i={};return n.set(i,r),i},unsubscribe:r=>n.delete(r)}};const{random:Je}=f.globals,g=()=>[...Array(10)].map(()=>Math.round(Je())),Y=Q(g()),Ke=t=>{Y.next(e=>e.map((n,r)=>{const i=t[r];return n===i?n:Math.min(Math.max(n-Tt,i),n+Tt)}))};var Qe=Object.defineProperty,Mt=Object.getOwnPropertySymbols,Ye=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable,It=(t,e,n)=>e in t?Qe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jt=(t,e)=>{for(var n in e||(e={}))Ye.call(e,n)&&It(t,n,e[n]);if(Mt)for(var n of Mt(e))Ve.call(e,n)&&It(t,n,e[n]);return t};const{render:tn,html:en}=f.uhtml,{DocumentFragment:nn}=f.globals,m=(t,e)=>{const n=new nn,r=o=>tn(n,e(en)(o));let i=t;return{render:()=>r(i),update:o=>{i=jt(jt({},i),o(i)),r(i)}}},rn=t=>t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`),u=t=>Object.entries(t).reduce((e,[n,r])=>`${e}${rn(n)}:${r};`,"");var on=Object.defineProperty,Pt=Object.getOwnPropertySymbols,sn=Object.prototype.hasOwnProperty,an=Object.prototype.propertyIsEnumerable,Ct=(t,e,n)=>e in t?on(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cn=(t,e)=>{for(var n in e||(e={}))sn.call(e,n)&&Ct(t,n,e[n]);if(Pt)for(var n of Pt(e))an.call(e,n)&&Ct(t,n,e[n]);return t};const ln=(t,e)=>m({bit:t},n=>({bit:r})=>{const i=255*r,o=255-i,s=u({display:"inline-block",width:e,height:e,lineHeight:e,fontSize:e,textAlign:"center",backgroundColor:`rgb(${i},${i},${i})`,color:`rgb(${o},${o},${o})`});return n`<div style=${s}>${r<.5?0:1}</div>`});var M=(t,e)=>{const n={tape:g(),style:{}},r=`min(${t}vw, ${e}vh)`,i=n.tape.map(o=>ln(o,r));return m(n,o=>({tape:s,style:l})=>{const a=u(cn({width:`calc(${r} * 10)`,height:r},l));return i.forEach((c,p)=>c.update(()=>({bit:s[p]}))),o`<div style=${a}>${i.map(c=>c.render())}</div>`})};const Nt=M(15,30),Rt=m({position:0},t=>({position:e})=>{const n=u({position:"absolute",top:"30%",left:"50%",transform:`translateX(calc(-5% - ${e} * 10%))`});return t`<div style=${n}>${Nt.render()}</div>`});Y.subscribe(t=>Nt.update(()=>({tape:t})));var dn=Object.defineProperty,pn=Object.defineProperties,un=Object.getOwnPropertyDescriptors,kt=Object.getOwnPropertySymbols,$n=Object.prototype.hasOwnProperty,mn=Object.prototype.propertyIsEnumerable,Lt=(t,e,n)=>e in t?dn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,V=(t,e)=>{for(var n in e||(e={}))$n.call(e,n)&&Lt(t,n,e[n]);if(kt)for(var n of kt(e))mn.call(e,n)&&Lt(t,n,e[n]);return t},tt=(t,e)=>pn(t,un(e));const bn={state:0},fn=t=>"E01234AH"[t+1],y="min(15vw, 30vh)",_=`calc(${y} / 16)`,gn=u({position:"absolute",top:"30%",left:`calc(50% - ${y} * 9 / 16)`}),zt={position:"absolute",height:y,background:"radial-gradient(#aaa, #666)"},Wt=tt(V({},zt),{width:`calc(${y} / 8)`,borderRadius:`${_} ${_} 0 0`}),hn=u(Wt),yn=u(tt(V({},Wt),{left:y})),vn=u(tt(V({},zt),{top:y,width:`calc(${y} * 9 / 8)`,borderRadius:`0 0 ${_} ${_}`,fontSize:`calc(${y} * 0.8)`,lineHeight:y,textAlign:"center",color:"white"})),v=m(bn,t=>({state:e})=>t`<div style=${gn}><div style=${hn} /><div style=${yn} /><div style=${vn}>${fn(e)}</div></div>`),_t=M(5,7),Ut=M(5,7),Dt=t=>_t.update(()=>({tape:t})),xn=u({position:"absolute",top:"3%",width:"100%",fontFamily:"serif",color:"white"}),wn=u({margin:"0 auto",fontSize:"min(3vw, 4.2vh)",lineHeight:"min(3vw, 4.2vh)"}),Sn=m({},t=>()=>t`<div style=${xn}><table style=${wn}><tr><td>ORDER:</td><td>${_t.render()}</td></tr><tr><td>TAPE:</td><td>${Ut.render()}</td></tr></table></div>`);Y.subscribe(t=>Ut.update(()=>({tape:t})));const An={number:1,timeLeft:0,score:0},et="min(3vw, 4.2vh)",On=u({position:"absolute",top:"1%",left:"1%",fontSize:et,color:"white",fontFamily:"serif"}),Tn=u({fontSize:`calc(${et} * 0.7)`}),En=u({position:"absolute",bottom:"1%",left:"1%",fontSize:et,color:"white",fontFamily:"serif"}),nt=t=>[...t.toString()].reduceRight(([e,n],r)=>e.length===3?[r,`,${e}${n}`]:[`${r}${e}`,n],["",""]).join``,Ht=t=>(t*100|0).toString().padStart(4,"0").replace(/^(..)(..)/,"$1.$2"),I=m(An,t=>({number:e,timeLeft:n,score:r})=>t`<div style=${On}>No.${e}<span style=${Tn}>/${Ot}</span><br>${Ht(n)}</div><div style=${En}>Score: ${nt(r)}</div>`),j=[...Array(10)].map((t,e)=>({direction:1,nextChar:e&1,nextState:e>>1})),w=Q(j),rt=(t,e)=>w.next(n=>[...n.slice(0,t),e(n[t]),...n.slice(t+1)]),Ft=Q([]),P=t=>Ft.next(e=>[...e,t]),C=()=>{let t;return Ft.next(([e,...n])=>(t=e,n)),t},b={reset:{},halt:{},pass:{},run:{},goNext:{}};var Mn=Object.defineProperty,In=Object.defineProperties,jn=Object.getOwnPropertyDescriptors,Bt=Object.getOwnPropertySymbols,Pn=Object.prototype.hasOwnProperty,Cn=Object.prototype.propertyIsEnumerable,qt=(t,e,n)=>e in t?Mn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,it=(t,e)=>{for(var n in e||(e={}))Pn.call(e,n)&&qt(t,n,e[n]);if(Bt)for(var n of Bt(e))Cn.call(e,n)&&qt(t,n,e[n]);return t},ot=(t,e)=>In(t,jn(e));const Nn=(t,e)=>({state0:t,char0:e,direction:1,char1:e,state1:t,disabled:!1}),Rn=u({display:"inline-block",margin:"1% 1%",textAlign:"center",whiteSpace:"nowrap"}),kn=t=>t<0?"L":"R",Ln=["0","1","2","3","4","A"],zn=(t,e)=>()=>{rt(t,n=>ot(it({},n),{direction:-e}))},Wn=(t,e)=>()=>{rt(t,n=>ot(it({},n),{nextChar:1-e}))},_n=(t,e)=>()=>{rt(t,n=>ot(it({},n),{nextState:(e+1)%6}))};var Un=t=>m(Nn(t>>1,t&0),e=>({state0:n,char0:r,direction:i,char1:o,state1:s,disabled:l})=>e`<div style=${Rn}>${`<${n},${r},`}<button onclick=${zn(t,i)} .disabled=${l}>${kn(i)}</button>${","}<button onclick=${Wn(t,o)} .disabled=${l}>${o}</button>${","}<button onclick=${_n(t,s)} .disabled=${l}>${Ln[s]}</button>${">"}</div>`),Dn=Object.defineProperty,Gt=Object.getOwnPropertySymbols,Hn=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,Xt=(t,e,n)=>e in t?Dn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Bn=(t,e)=>{for(var n in e||(e={}))Hn.call(e,n)&&Xt(t,n,e[n]);if(Gt)for(var n of Gt(e))Fn.call(e,n)&&Xt(t,n,e[n]);return t};const qn={style:{display:"none"},disabled:!0},st=[...Array(10)].map((t,e)=>Un(e)),N="min(4vw, 6vh)",Gn=t=>u(Bn({position:"absolute",top:"29%",left:"50%",transform:"translate(-50%, 0)",width:`calc(${N} * 20)`,padding:"5px 0 10px 0",textAlign:"center",fontSize:N,lineHeight:N,border:"1px solid #999",backgroundColor:"rgba(51, 51, 153, 0.8)",color:"white",fontFamily:"Courier New"},t)),Xn=u({marginBottom:"10px"}),at=`calc(${N} * 1.3)`,Zn=u({height:at,marginTop:"0.1em",padding:"0 1em",fontSize:at,lineHeight:at,borderRadius:`calc(${N} * 0.15)`}),U=m(qn,(({onClickRunButton:t})=>e=>({style:n,disabled:r})=>(st.forEach(i=>i.update(()=>({disabled:r}))),e`<div style=${Gn(n)}><span style=${Xn}>Program</span><div>${st.map(i=>i.render())}</div><button style=${Zn} .disabled=${r} onclick=${t}>RUN</button></div>`))({onClickRunButton:()=>{P(b.run),U.update(()=>({disabled:!0}))}}));w.subscribe(t=>{t.forEach(({direction:e,nextChar:n,nextState:r},i)=>st[i].update(()=>({state0:i>>1,char0:i&1,direction:e,char1:n,state1:r})))});const Jn={running:!1,disabled:!0},Kn=u({display:"table-cell",position:"absolute",top:"19%",width:"100%",height:"10%",textAlign:"center",verticalAlign:"middle",fontFamily:"Courier New"}),R="min(5vw, 6.5vh)",Zt=u({margin:`calc(5vh - ${R} / 2) 0.5em`,width:`calc(${R} * 5)`,height:R,fontSize:R,borderRadius:`calc(${R} * 0.15)`}),Qn=()=>P(b.reset),Yn=()=>P(b.halt),Vn=()=>P(b.pass),ct=m(Jn,t=>({running:e,disabled:n})=>t`<div style=${Kn}><button style=${Zt} onclick=${e?Yn:Qn} .disabled=${n}>${e?"HALT":"RESET"}</button><button style=${Zt} onclick=${Vn} .disabled=${n||e}>PASS</button></div>`),tr=t=>u({display:t===0?"none":"block",position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",opacity:t}),er=()=>P(b.goNext);var x=m({opacity:0},t=>({opacity:e})=>t`<div style=${tr(e)} onclick=${er}></div>`);const h={pass:{},solved:{},timeup:{}},nr={type:h.pass,commandsSaved:0,accepted:!1,steps:0,timeLeft:0,opacity:0},rr=t=>u({display:t===0?"none":"block",position:"absolute",top:"10%",width:"100%",textAlign:"center",color:"white",opacity:t,filter:"drop-shadow(0 0 0.3rem black)"}),ir=new Map([[h.pass,"#ccc"],[h.solved,"#cfc"],[h.timeup,"#ccf"]]),D="min(4vw, 6vh)",or=t=>u({color:ir.get(t),fontSize:`calc(${D} * 1.3)`}),sr=new Map([[h.pass,"Pass"],[h.solved,"Solved!"],[h.timeup,"Time's up."]]),ar=u({display:"inline-block",margin:`${D} 0`,fontSize:D,color:"white"}),cr=u({fontSize:D}),Jt=(t,e,n,r)=>(t+(e?1:0))*100*n*.1*(r/E)*3|0,H=m(nr,t=>({type:e,commandsSaved:n,accepted:r,steps:i,timeLeft:o,opacity:s})=>t`<div style=${rr(s)}><div style=${or(e)}>${sr.get(e)}</div><table style=${ar}><tr><td>Saved + accepted</td><td /><td>Steps</td><td /><td>Time left</td></tr><tr><td>((${n} + ${r?1:0}) &times; 100)</td><td>&times;</td><td>(${i} &times; 0.1)</td><td>&times;</td><td>(${Ht(o)} / ${E}.00 &times; 3)</td></tr></table><div style=${cr}>Score: +${nt(Jt(n,r,i,o))}</div></div>`),lr={finished:!1,order:Array(10).fill(0),tape:Array(10).fill(0),score:0,opacity:0},S="min(4vw, 6vh)",dr=t=>u({display:t===0?"none":"block",position:"absolute",top:"10%",width:"100%",fontSize:S,lineHeight:S,textAlign:"center",color:"white",opacity:t,filter:"drop-shadow(0 0 0.3rem black)"}),pr=t=>u({marginBottom:S,fontSize:`calc(${S} * 1.3)`,color:t?"#fc9":"#c99"}),lt=M(4,6),dt=M(4,6),ur={display:"inline-block"};[lt,dt].forEach(t=>t.update(()=>({style:ur})));const $r=u({fontSize:S,marginTop:S}),pt=m(lr,t=>({finished:e,caseNumber:n,order:r,tape:i,score:o,opacity:s})=>{lt.update(()=>({tape:r})),dt.update(()=>({tape:i}));const l=`display:${e?"none":"block"}`,a=e?"":`at No.${n}`;return t`<div style=${dr(s)}><div style=${pr(e)}>${e?"Finished!":"Game Over"}</div><div style=${l}>${a}</div>${e?"":lt.render()}<br>${e?"":dt.render()}<br><div style=${$r}>Total score: ${nt(o)}</div></div>`}),mr={opacity:0},br=t=>u({display:t===0?"none":"block",position:"absolute",width:"100%",top:"30%",textAlign:"center",color:"white",opacity:t}),fr=u({fontSize:"min(12vw, 18vh)",color:"orange"}),F=m(mr,t=>({opacity:e})=>t`<div style=${br(e)}><div style=${fr}>TMP</div></div>`);var d={title:{title:{}},main:{programWindowOpening:{},programming:{},programWindowClosing:{},running:{}},result:{caseResult:{},totalResult:{}}};const{now:gr}=f.globals,Kt=({startedAt:t})=>{const e=Math.max(E-(gr()-t)/1e3,0);I.update(()=>({timeLeft:e}))},hr=(t,e)=>{const n=e-t,r=n*Ze;return J<Math.abs(r)?t+r:t+Math.min(Math.max(-J,n),J)},k=({currentTape:t,position:e})=>{Ke(t),Rt.update(({position:n})=>({position:hr(n,e)}))},Qt=(t,e)=>{const n=Math.max((1-t/20)*50,0),r=Math.min((1+t/20)*50,100),i=Math.min(Math.max((t-30)/10,0)*87+13,100);U.update(()=>({style:{clipPath:`polygon(${n}% 0, ${r}% 0, ${r}% ${i}%, ${n}% ${i}%)`},disabled:e}))},{now:yr,random:ut}=f.globals;var Yt=(t=0,e=0)=>({currentTape:n,position:r,machineState:i})=>{if(t===0){const s=g();return Dt(s),I.update(()=>({number:1,timeLeft:E,score:0})),x.update(()=>({opacity:1})),{nextId:d.title.title,nextArgs:[1],stateUpdate:{position:0,machineState:0,order:s,currentTape:g()}}}if(k({currentTape:n,position:r}),v.update(()=>({state:i})),t<30)return F.update(()=>({opacity:t/30})),{nextId:d.title.title,nextArgs:[t+1]};if(t===30)return{nextId:d.title.title,nextArgs:[C()===b.goNext?31:30,(e+1)%K],stateUpdate:e===0?{currentTape:[...n.slice(0,r),Math.round(ut()),...n.slice(r+1,10)],position:{0:1,9:8}[r]||r+(ut()<.5?-1:1),machineState:Math.floor(ut()*5)}:{}};if(t<50){const s=(50-t)/20;return F.update(()=>({opacity:s})),x.update(()=>({opacity:s})),{nextId:d.title.title,nextArgs:[t+1]}}F.update(()=>({opacity:0})),x.update(()=>({opacity:0})),w.next(()=>j);const o=g();return{nextId:d.main.programWindowOpening,nextArgs:[0],stateUpdate:{caseNumber:1,score:0,order:g(),originalTape:o,currentTape:o,position:0,machinState:0,executedIndices:new Map,startedAt:yr()}}},vr=Object.defineProperty,xr=Object.defineProperties,wr=Object.getOwnPropertyDescriptors,Vt=Object.getOwnPropertySymbols,Sr=Object.prototype.hasOwnProperty,Ar=Object.prototype.propertyIsEnumerable,te=(t,e,n)=>e in t?vr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Or=(t,e)=>{for(var n in e||(e={}))Sr.call(e,n)&&te(t,n,e[n]);if(Vt)for(var n of Vt(e))Ar.call(e,n)&&te(t,n,e[n]);return t},Tr=(t,e)=>xr(t,wr(e));const{now:Er}=f.globals,ee=(t,e,n)=>({type:t,time:0,accepted:e,timeLeft:n}),Mr=(t,e)=>(t*6+e)/7|0,Ir=t=>({executedIndices:e,steps:n,caseNumber:r,score:i})=>{const{time:o,type:s,accepted:l,timeLeft:a}=t;x.update(()=>({opacity:Math.min(o/10,1)})),H.update(()=>({opacity:Math.min(Math.max(0,(o-10)/30),1)})),o===0&&(H.update(()=>({type:s,commandsSaved:10-e.size,accepted:l,steps:n,timeLeft:a})),U.update(()=>({disabled:!0}))),I.update(({score:p})=>({score:o===40?i:Mr(p,i)}));const c=C();if(o>=40&&c===b.goNext){if(H.update(()=>({opacity:0})),r===Ot)return{nextId:d.result.totalResult,nextArgs:[!0,0]};const p=r+1;I.update(()=>({number:p}));const $=g();return x.update(()=>({opacity:0})),w.next(()=>j),v.update(()=>({state:0})),{nextId:d.main.programWindowOpening,nextArgs:[0],stateUpdate:{caseNumber:p,order:g(),originalTape:$,currentTape:$,position:0,machineState:0,executedIndices:new Map,startedAt:Er()}}}return{nextId:d.result.caseResult,nextArgs:[Tr(Or({},t),{time:o+1})],stateUpdate:o===0?{score:i+Jt(10-e.size,l,n,a)}:{}}},jr=(t,e)=>({order:n,originalTape:r,score:i,caseNumber:o})=>{const s=C();return e<=40?(x.update(()=>({opacity:Math.min(e/10,1)})),pt.update(()=>({opacity:Math.max(0,(e-10)/30),finished:t,score:i,caseNumber:o,order:n,tape:r})),{nextId:d.result.totalResult,nextArgs:[t,e+1]}):e===41?{nextId:d.result.totalResult,nextArgs:[t,s===b.goNext?42:41]}:e<=61?(pt.update(()=>({opacity:(61-e)/20})),{nextId:d.result.totalResult,nextArgs:[t,e+1]}):{nextId:d.title.title,nextArgs:[0]}},{now:B}=f.globals,q=(t,e)=>Math.max(E-(t-e)/1e3,0),Pr=t=>e=>{Dt(e.order);const n=t<Et;return Qt(t,n),k(e),ct.update(()=>({running:!1,disabled:n})),Kt(e),n?{nextId:d.main.programWindowOpening,nextArgs:[t+1]}:{nextId:d.main.programming,nextArgs:[]}},Cr=()=>t=>{k(t),Kt(t);const e=C();return e===b.run?(v.update(()=>({state:0})),{nextId:d.main.programWindowClosing,nextArgs:[Et],stateUpdate:{currentTape:t.originalTape,machineState:0,position:0,runAt:B()}}):(e===b.reset&&w.next(()=>j),e===b.pass?{nextId:d.result.caseResult,nextArgs:[ee(h.pass,!1,q(B(),t.startedAt))],stateUpdate:{steps:0}}:{nextId:d.main.programming,nextArgs:[],stateUpdate:e===b.reset?{currentTape:t.originalTape,machineState:0,position:0}:{}})},Nr=t=>e=>(Qt(t,!0),k(e),ct.update(()=>({running:t===0,disabled:t>0})),t===0?{nextId:d.main.running,nextArgs:[0],stateUpdate:{steps:0,executedIndices:new Set}}:{nextId:d.main.programWindowClosing,nextArgs:[t-1]});let ne=j;w.subscribe(t=>{ne=t});const Rr=({currentTape:t,position:e,machineState:n,steps:r,executedIndices:i})=>{const o=n<<1|t[e],{direction:s,nextChar:l,nextState:a}=ne[o];return{currentTape:[...t.slice(0,e),l,...t.slice(e+1)],position:e+s,machineState:a,steps:r+1,executedIndices:new Set([...i,o])}},kr=t=>e=>{const{position:n,machineState:r,startedAt:i,runAt:o,order:s,currentTape:l}=e;if(C()===b.halt)return v.update(()=>({state:6})),q(B(),i)>0?{nextId:d.main.programWindowOpening,nextArgs:[0]}:{nextId:d.result.totalResult,nextArgs:[!1,0]};k(e);const a=n<0||n>=10?-1:r;if([-1,5].includes(a)&&t===K){if(v.update(()=>({state:a})),s.join``===l.join``){const c=q(o,i),p=c>0?h.solved:h.timeup;return{nextId:d.result.caseResult,nextArgs:[ee(p,a===5,c)]}}return q(B(),i)>0?{nextId:d.main.programWindowOpening,nextArgs:[0],stateUpdate:{machineState:a}}:{nextId:d.result.totalResult,nextArgs:[!1,0]}}return v.update(()=>({state:r})),{nextId:d.main.running,nextArgs:[t===K?0:t+1],stateUpdate:t===0?Rr(e):{}}};var Lr=Object.defineProperty,re=Object.getOwnPropertySymbols,zr=Object.prototype.hasOwnProperty,Wr=Object.prototype.propertyIsEnumerable,ie=(t,e,n)=>e in t?Lr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oe=(t,e)=>{for(var n in e||(e={}))zr.call(e,n)&&ie(t,n,e[n]);if(re)for(var n of re(e))Wr.call(e,n)&&ie(t,n,e[n]);return t};const{now:_r}=f.globals,Ur=new Map([[d.title.title,Yt],[d.main.programWindowOpening,Pr],[d.main.programming,Cr],[d.main.programWindowClosing,Nr],[d.main.running,kr],[d.result.caseResult,Ir],[d.result.totalResult,jr]]),Dr=(t,e)=>({score:0,caseNumber:1,order:t,originalTape:e,currentTape:e,position:0,machineState:0,startedAt:_r(),runAt:null,steps:0,executedIndices:new Set}),se=(t,e)=>()=>{const{nextId:n,nextArgs:r,stateUpdate:i}=t(e);return se(Ur.get(n)(...r),oe(oe({},e),i))},{render:Hr,html:Fr}=f.uhtml;Hr(document.getElementById("root"),Fr`${[I,Sn,Rt,v,ct,U,x,H,pt,F].map(t=>t.render())}`),At(se(Yt(0),Dr(g(),g())),St)})();
