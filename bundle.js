(function(){"use strict";var X=t=>({get:e=>t.get(e),set:(e,n)=>(t.set(e,n),n)});const ft=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,pe=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,ue=/<[a-z][^>]+$/i,fe=/>[^<>]*$/,$e=/<([a-z]+[a-z0-9:._-]*)([^>]*?)(\/>)/ig,me=/\s+$/,$t=(t,e)=>0<e--&&(ue.test(t[e])||!fe.test(t[e])&&$t(t,e)),ge=(t,e,n)=>pe.test(e)?t:`<${e}${n.replace(me,"")}></${e}>`;var he=(t,e,n)=>{const r=[],{length:o}=t;for(let a=1;a<o;a++){const l=t[a-1];r.push(ft.test(l)&&$t(t,a)?l.replace(ft,(c,i,p)=>`${e}${a-1}=${p||'"'}${i}${p?"":'"'}`):`${l}<!--${e}${a-1}-->`)}r.push(t[o-1]);const s=r.join("").trim();return n?s:s.replace($e,ge)};const{isArray:Z}=Array,{indexOf:ye,slice:mt}=[],ve=1,gt=111,be=({firstChild:t,lastChild:e})=>{const n=document.createRange();return n.setStartAfter(t),n.setEndAfter(e),n.deleteContents(),t},we=(t,e)=>t.nodeType===gt?1/e<0?e?be(t):t.lastChild:e?t.valueOf():t.firstChild:t,Se=t=>{const{childNodes:e}=t,{length:n}=e;if(n<2)return n?e[0]:t;const r=mt.call(e,0),o=r[0],s=r[n-1];return{ELEMENT_NODE:ve,nodeType:gt,firstChild:o,lastChild:s,valueOf(){if(e.length!==n){let a=0;for(;a<n;)t.appendChild(r[a++])}return t}}};var xe=(t,e,n,r,o)=>{const s=n.length;let a=e.length,l=s,c=0,i=0,p=null;for(;c<a||i<l;)if(a===c){const f=l<s?i?r(n[i-1],-0).nextSibling:r(n[l-i],0):o;for(;i<l;)t.insertBefore(r(n[i++],1),f)}else if(l===i)for(;c<a;)(!p||!p.has(e[c]))&&t.removeChild(r(e[c],-1)),c++;else if(e[c]===n[i])c++,i++;else if(e[a-1]===n[l-1])a--,l--;else if(e[c]===n[l-1]&&n[i]===e[a-1]){const f=r(e[--a],-1).nextSibling;t.insertBefore(r(n[i++],1),r(e[c++],-1).nextSibling),t.insertBefore(r(n[--l],1),f),e[a]=n[l]}else{if(!p){p=new Map;let f=i;for(;f<l;)p.set(n[f],f++)}if(p.has(e[c])){const f=p.get(e[c]);if(i<f&&f<l){let z=c,ut=1;for(;++z<a&&z<l&&p.get(e[z])===f+ut;)ut++;if(ut>f-i){const Rr=r(e[c],0);for(;i<f;)t.insertBefore(r(n[i++],1),Rr)}else t.replaceChild(r(n[i++],1),r(e[c++],-1))}else c++}else t.removeChild(r(e[c++],-1))}return n};const _e=t=>e=>{for(const n in e){const r=n==="role"?n:`aria-${n}`,o=e[n];o==null?t.removeAttribute(r):t.setAttribute(r,o)}},Oe=(t,e)=>{let n,r=!0;const o=document.createAttributeNS(null,e);return s=>{n!==s&&(n=s,n==null?r||(t.removeAttributeNode(o),r=!0):(o.value=s,r&&(t.setAttributeNodeNS(o),r=!1)))}},Ae=(t,e,n)=>r=>{n!==!!r&&((n=!!r)?t.setAttribute(e,""):t.removeAttribute(e))},Pe=({dataset:t})=>e=>{for(const n in e){const r=e[n];r==null?delete t[n]:t[n]=r}},ht=(t,e)=>{let n,r=e.slice(2);return!(e in t)&&e.toLowerCase()in t&&(r=r.toLowerCase()),o=>{const s=Z(o)?o:[o,!1];n!==s[0]&&(n&&t.removeEventListener(r,n,s[1]),(n=s[0])&&t.addEventListener(r,n,s[1]))}},Te=t=>{let e;return n=>{e!==n&&(e=n,typeof n=="function"?n(t):n.current=t)}},Ee=(t,e)=>e==="dataset"?Pe(t):n=>{t[e]=n},Ce=t=>{let e;return n=>{e!=n&&(e=n,t.textContent=n==null?"":n)}};/*! (c) Andrea Giammarchi - ISC */var yt=function(t){var e="fragment",n="template",r="content"in a(n),o=r?function(c){var i=a(n);return i.innerHTML=c,i.content}:function(c){var i=a(e),p=a(n),f=null;if(/^[^\S]*?<(col(?:group)?|t(?:head|body|foot|r|d|h))/i.test(c)){var z=RegExp.$1;p.innerHTML="<table>"+c+"</table>",f=p.querySelectorAll(z)}else p.innerHTML=c,f=p.childNodes;return s(i,f),i};return function(i,p){return(p==="svg"?l:o)(i)};function s(c,i){for(var p=i.length;p--;)c.appendChild(i[0])}function a(c){return c===e?t.createDocumentFragment():t.createElementNS("http://www.w3.org/1999/xhtml",c)}function l(c){var i=a(e),p=a("div");return p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+c+"</svg>",s(i,p.firstChild.childNodes),i}}(document);const Ie=({childNodes:t},e)=>t[e],J=t=>{const e=[];let{parentNode:n}=t;for(;n;)e.push(ye.call(n.childNodes,t)),t=n,n=t.parentNode;return e},{createTreeWalker:vt,importNode:K}=document,bt=K.length!=1,Me=bt?(t,e,n)=>K.call(document,yt(t,e,n),!0):yt,Ne=bt?t=>vt.call(document,t,1|128,null,!1):t=>vt.call(document,t,1|128),O=(t,e,n)=>xe(t.parentNode,e,n,we,t),Re=t=>{let e,n,r=[];const o=s=>{switch(typeof s){case"string":case"number":case"boolean":e!==s&&(e=s,n||(n=document.createTextNode("")),n.data=s,r=O(t,r,[n]));break;case"object":case"undefined":if(s==null){e!=s&&(e=s,r=O(t,r,[]));break}if(Z(s)){e=s,s.length===0?r=O(t,r,[]):typeof s[0]=="object"?r=O(t,r,s):o(String(s));break}e!==s&&"ELEMENT_NODE"in s&&(e=s,r=O(t,r,s.nodeType===11?mt.call(s.childNodes):[s]));break;case"function":o(s(t));break}};return o},je=(t,e)=>{switch(e[0]){case"?":return Ae(t,e.slice(1),!1);case".":return Ee(t,e.slice(1));case"@":return ht(t,"on"+e.slice(1));case"o":if(e[1]==="n")return ht(t,e)}switch(e){case"ref":return Te(t);case"aria":return _e(t)}return Oe(t,e)};function Le(t){const{type:e,path:n}=t,r=n.reduceRight(Ie,this);return e==="node"?Re(r):e==="attr"?je(r,t.name):Ce(r)}const A="is\xB5",wt=X(new WeakMap),ze=/^(?:plaintext|script|style|textarea|title|xmp)$/i,P=()=>({stack:[],entry:null,wire:null}),ke=(t,e)=>{const{content:n,updates:r}=He(t,e);return{type:t,template:e,content:n,updates:r,wire:null}},We=(t,e)=>{const n=he(e,A,t==="svg"),r=Me(n,t),o=Ne(r),s=[],a=e.length-1;let l=0,c=`${A}${l}`;for(;l<a;){const i=o.nextNode();if(!i)throw`bad template: ${n}`;if(i.nodeType===8)i.data===c&&(s.push({type:"node",path:J(i)}),c=`${A}${++l}`);else{for(;i.hasAttribute(c);)s.push({type:"attr",path:J(i),name:i.getAttribute(c)}),i.removeAttribute(c),c=`${A}${++l}`;ze.test(i.tagName)&&i.textContent.trim()===`<!--${c}-->`&&(i.textContent="",s.push({type:"text",path:J(i)}),c=`${A}${++l}`)}}return{content:r,nodes:s}},He=(t,e)=>{const{content:n,nodes:r}=wt.get(e)||wt.set(e,We(t,e)),o=K.call(document,n,!0),s=r.map(Le,o);return{content:o,updates:s}},k=(t,{type:e,template:n,values:r})=>{const{length:o}=r;St(t,r,o);let{entry:s}=t;(!s||s.template!==n||s.type!==e)&&(t.entry=s=ke(e,n));const{content:a,updates:l,wire:c}=s;for(let i=0;i<o;i++)l[i](r[i]);return c||(s.wire=Se(a))},St=({stack:t},e,n)=>{for(let r=0;r<n;r++){const o=e[r];o instanceof Q?e[r]=k(t[r]||(t[r]=P()),o):Z(o)?St(t[r]||(t[r]=P()),o,o.length):t[r]=null}n<t.length&&t.splice(n)};function Q(t,e,n){this.type=t,this.template=e,this.values=n}const{create:Ue,defineProperties:De}=Object,xt=t=>{const e=X(new WeakMap),n=r=>(o,...s)=>k(r,{type:t,template:o,values:s});return De((r,...o)=>new Q(t,r,o),{for:{value(r,o){const s=e.get(r)||e.set(r,Ue(null));return s[o]||(s[o]=n(P()))}},node:{value:(r,...o)=>k(P(),{type:t,template:r,values:o}).valueOf()}})},_t=X(new WeakMap),Fe=(t,e)=>{const n=typeof e=="function"?e():e,r=_t.get(t)||_t.set(t,P()),o=n instanceof Q?k(r,n):n;return o!==r.wire&&(r.wire=o,t.textContent="",t.appendChild(o.valueOf())),t},Be=xt("html");xt("svg");var g={uhtml:{render:Fe,html:Be},globals:{now:Date.now,window,setTimeout,random:Math.random,DocumentFragment}};const{now:Ot,setTimeout:Ge}=g.globals,At=1e3/60,Pt=(t,e)=>{const n=Ot(),r=t();Ge(()=>{const o=Ot()<n+At?e+1:Math.max(e-1,1);Pt(r,o)},e)},Tt=32,T=32,qe=1/5,Y=1/15,Et=1/15,Ct=45,V=30;var tt=t=>{let e=t;const n=new Map;return{next:r=>{e=r(e),n.forEach(o=>o(e))},subscribe:r=>{r(e);const o={};return n.set(o,r),o},unsubscribe:r=>n.delete(r)}};const{random:Xe}=g.globals,h=()=>[...Array(10)].map(()=>Math.round(Xe())),et=tt(h()),Ze=t=>{et.next(e=>e.map((n,r)=>{const o=t[r];return n===o?n:Math.min(Math.max(n-Et,o),n+Et)}))};var Je=Object.defineProperty,Ke=Object.prototype.hasOwnProperty,It=Object.getOwnPropertySymbols,Qe=Object.prototype.propertyIsEnumerable,Mt=(t,e,n)=>e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nt=(t,e)=>{for(var n in e||(e={}))Ke.call(e,n)&&Mt(t,n,e[n]);if(It)for(var n of It(e))Qe.call(e,n)&&Mt(t,n,e[n]);return t};const{render:Ye,html:Ve}=g.uhtml,{DocumentFragment:tn}=g.globals,$=(t,e)=>{const n=new tn,r=s=>Ye(n,e(Ve)(s));let o=t;return{render:()=>r(o),update:s=>{o=Nt(Nt({},o),s(o)),r(o)}}},en=t=>t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`),u=t=>Object.entries(t).reduce((e,[n,r])=>`${e}${en(n)}:${r};`,"");var nn=Object.defineProperty,rn=Object.prototype.hasOwnProperty,Rt=Object.getOwnPropertySymbols,on=Object.prototype.propertyIsEnumerable,jt=(t,e,n)=>e in t?nn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sn=(t,e)=>{for(var n in e||(e={}))rn.call(e,n)&&jt(t,n,e[n]);if(Rt)for(var n of Rt(e))on.call(e,n)&&jt(t,n,e[n]);return t};const an=(t,e)=>$({bit:t},n=>({bit:r})=>{const o=255*r,s=255-o,a=u({display:"inline-block",width:e,height:e,lineHeight:e,fontSize:e,textAlign:"center",backgroundColor:`rgb(${o},${o},${o})`,color:`rgb(${s},${s},${s})`});return n`<div style=${a}>${r<.5?0:1}</div>`});var E=(t,e)=>{const n={tape:h(),style:{}},r=`min(${t}vw, ${e}vh)`,o=n.tape.map(s=>an(s,r));return $(n,s=>({tape:a,style:l})=>{const c=u(sn({width:`calc(${r} * 10)`,height:r},l));return o.forEach((i,p)=>i.update(()=>({bit:a[p]}))),s`<div style=${c}>${o.map(i=>i.render())}</div>`})};const Lt=E(15,30),zt=$({position:0},t=>({position:e})=>{const n=u({position:"absolute",top:"30%",left:"50%",transform:`translateX(calc(-5% - ${e} * 10%))`});return t`<div style=${n}>${Lt.render()}</div>`});et.subscribe(t=>Lt.update(()=>({tape:t})));var cn=Object.defineProperty,ln=Object.prototype.hasOwnProperty,kt=Object.getOwnPropertySymbols,dn=Object.prototype.propertyIsEnumerable,Wt=(t,e,n)=>e in t?cn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,S=(t,e)=>{for(var n in e||(e={}))ln.call(e,n)&&Wt(t,n,e[n]);if(kt)for(var n of kt(e))dn.call(e,n)&&Wt(t,n,e[n]);return t};const pn={state:0},un=t=>"E01234AH"[t+1],v="min(15vw, 30vh)",W=`calc(${v} / 16)`,fn=u({position:"absolute",top:"30%",left:`calc(50% - ${v} * 9 / 16)`}),Ht={position:"absolute",height:v,background:"radial-gradient(#aaa, #666)"},Ut=S(S({},Ht),{width:`calc(${v} / 8)`,borderRadius:`${W} ${W} 0 0`}),$n=u(Ut),mn=u(S(S({},Ut),{left:v})),gn=u(S(S({},Ht),{top:v,width:`calc(${v} * 9 / 8)`,borderRadius:`0 0 ${W} ${W}`,fontSize:`calc(${v} * 0.8)`,lineHeight:v,textAlign:"center",color:"white"})),b=$(pn,t=>({state:e})=>t`<div style=${fn}>    <div style=${$n} />    <div style=${mn} />    <div style=${gn}>${un(e)}</div>  </div>`),Dt=E(5,7),Ft=E(5,7),Bt=t=>Dt.update(()=>({tape:t})),hn=u({position:"absolute",top:"3%",width:"100%",fontFamily:"serif",color:"white"}),yn=u({margin:"0 auto",fontSize:"min(3vw, 4.2vh)",lineHeight:"min(3vw, 4.2vh)"}),vn=$({},t=>()=>t`<div style=${hn}>  <table style=${yn}>    <tr><td>ORDER:</td><td>${Dt.render()}</td></tr>    <tr><td>TAPE:</td><td>${Ft.render()}</td></tr>  </table></div>`);et.subscribe(t=>Ft.update(()=>({tape:t})));const bn={number:1,timeLeft:0,score:0},nt="min(3vw, 4.2vh)",wn=u({position:"absolute",top:"1%",left:"1%",fontSize:nt,color:"white",fontFamily:"serif"}),Sn=u({fontSize:`calc(${nt} * 0.7)`}),xn=u({position:"absolute",bottom:"1%",left:"1%",fontSize:nt,color:"white",fontFamily:"serif"}),rt=t=>[...t.toString()].reduceRight(([e,n],r)=>e.length===3?[r,`,${e}${n}`]:[`${r}${e}`,n],["",""]).join``,Gt=t=>(t*100|0).toString().padStart(4,"0").replace(/^(..)(..)/,"$1.$2"),C=$(bn,t=>({number:e,timeLeft:n,score:r})=>t`  <div style=${wn}>    No.${e}<span style=${Sn}>/${Tt}</span><br>    ${Gt(n)}  </div>  <div style=${xn}>Score: ${rt(r)}</div>`),I=[...Array(10)].map((t,e)=>({direction:1,nextChar:e&1,nextState:e>>1})),x=tt(I),ot=(t,e)=>x.next(n=>[...n.slice(0,t),e(n[t]),...n.slice(t+1)]),qt=tt([]),M=t=>qt.next(e=>[...e,t]),N=()=>{let t;return qt.next(([e,...n])=>(t=e,n)),t},m={reset:{},halt:{},pass:{},run:{},goNext:{}};var _n=Object.defineProperty,On=Object.prototype.hasOwnProperty,Xt=Object.getOwnPropertySymbols,An=Object.prototype.propertyIsEnumerable,Zt=(t,e,n)=>e in t?_n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_=(t,e)=>{for(var n in e||(e={}))On.call(e,n)&&Zt(t,n,e[n]);if(Xt)for(var n of Xt(e))An.call(e,n)&&Zt(t,n,e[n]);return t};const Pn=(t,e)=>({state0:t,char0:e,direction:1,char1:e,state1:t,disabled:!1}),Tn=u({display:"inline-block",margin:"1% 1%",textAlign:"center",whiteSpace:"nowrap"}),En=t=>t<0?"L":"R",Cn=["0","1","2","3","4","A"],In=(t,e)=>()=>{ot(t,n=>_(_({},n),{direction:-e}))},Mn=(t,e)=>()=>{ot(t,n=>_(_({},n),{nextChar:1-e}))},Nn=(t,e)=>()=>{ot(t,n=>_(_({},n),{nextState:(e+1)%6}))};var Rn=t=>$(Pn(t>>1,t&0),e=>({state0:n,char0:r,direction:o,char1:s,state1:a,disabled:l})=>e`<div style=${Tn}>${`<${n},${r},`}<button onclick=${In(t,o)} .disabled=${l}>${En(o)}</button>${","}<button onclick=${Mn(t,s)} .disabled=${l}>${s}</button>${","}<button onclick=${Nn(t,a)} .disabled=${l}>${Cn[a]}</button>${">"}</div>`),jn=Object.defineProperty,Ln=Object.prototype.hasOwnProperty,Jt=Object.getOwnPropertySymbols,zn=Object.prototype.propertyIsEnumerable,Kt=(t,e,n)=>e in t?jn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kn=(t,e)=>{for(var n in e||(e={}))Ln.call(e,n)&&Kt(t,n,e[n]);if(Jt)for(var n of Jt(e))zn.call(e,n)&&Kt(t,n,e[n]);return t};const Wn={style:{display:"none"},disabled:!0},st=[...Array(10)].map((t,e)=>Rn(e)),R="min(4vw, 6vh)",Hn=t=>u(kn({position:"absolute",top:"29%",left:"50%",transform:"translate(-50%, 0)",width:`calc(${R} * 20)`,padding:"5px 0 10px 0",textAlign:"center",fontSize:R,lineHeight:R,border:"1px solid #999",backgroundColor:"rgba(51, 51, 153, 0.8)",color:"white",fontFamily:"Courier New"},t)),Un=u({marginBottom:"10px"}),it=`calc(${R} * 1.3)`,Dn=u({height:it,marginTop:"0.1em",padding:"0 1em",fontSize:it,lineHeight:it,borderRadius:`calc(${R} * 0.15)`}),H=$(Wn,(({onClickRunButton:t})=>e=>({style:n,disabled:r})=>(st.forEach(o=>o.update(()=>({disabled:r}))),e`<div style=${Hn(n)}>    <span style=${Un}>Program</span>    <div>${st.map(o=>o.render())}</div>    <button      style=${Dn}      .disabled=${r}      onclick=${t}>RUN</button>  </div>`))({onClickRunButton:()=>{M(m.run),H.update(()=>({disabled:!0}))}}));x.subscribe(t=>{t.forEach(({direction:e,nextChar:n,nextState:r},o)=>st[o].update(()=>({state0:o>>1,char0:o&1,direction:e,char1:n,state1:r})))});const Fn={running:!1,disabled:!0},Bn=u({display:"table-cell",position:"absolute",top:"19%",width:"100%",height:"10%",textAlign:"center",verticalAlign:"middle",fontFamily:"Courier New"}),j="min(5vw, 6.5vh)",Qt=u({margin:`calc(5vh - ${j} / 2) 0.5em`,width:`calc(${j} * 5)`,height:j,fontSize:j,borderRadius:`calc(${j} * 0.15)`}),Gn=()=>M(m.reset),qn=()=>M(m.halt),Xn=()=>M(m.pass),at=$(Fn,t=>({running:e,disabled:n})=>t`<div style=${Bn}>    <button      style=${Qt}      onclick=${e?qn:Gn}      .disabled=${n}>${e?"HALT":"RESET"}</button>    <button      style=${Qt}      onclick=${Xn}      .disabled=${n||e}>PASS</button>  </div>`),Zn=t=>u({display:t===0?"none":"block",position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)",opacity:t}),Jn=()=>M(m.goNext);var w=$({opacity:0},t=>({opacity:e})=>t`<div style=${Zn(e)} onclick=${Jn}></div>`);const y={pass:{},solved:{},timeup:{}},Kn={type:y.pass,commandsSaved:0,accepted:!1,steps:0,timeLeft:0,opacity:0},Qn=t=>u({display:t===0?"none":"block",position:"absolute",top:"10%",width:"100%",textAlign:"center",color:"white",opacity:t,filter:"drop-shadow(0 0 0.3rem black)"}),Yn=new Map([[y.pass,"#ccc"],[y.solved,"#cfc"],[y.timeup,"#ccf"]]),U="min(4vw, 6vh)",Vn=t=>u({color:Yn.get(t),fontSize:`calc(${U} * 1.3)`}),tr=new Map([[y.pass,"Pass"],[y.solved,"Solved!"],[y.timeup,"Time's up."]]),er=u({display:"inline-block",margin:`${U} 0`,fontSize:U,color:"white"}),nr=u({fontSize:U}),Yt=(t,e,n,r)=>(t+(e?1:0))*100*n*.1*(r/T)*3|0,D=$(Kn,t=>({type:e,commandsSaved:n,accepted:r,steps:o,timeLeft:s,opacity:a})=>t`<div style=${Qn(a)}>    <div style=${Vn(e)}>${tr.get(e)}</div>    <table style=${er}>      <tr>        <td>Saved + accepted</td>        <td />        <td>Steps</td>        <td />        <td>Time left</td>      </tr>      <tr>        <td>((${n} + ${r?1:0}) &times; 100)</td>        <td>&times;</td>        <td>(${o} &times; 0.1)</td>        <td>&times;</td>        <td>(${Gt(s)} / ${T}.00 &times; 3)</td>      </tr>    </table>    <div style=${nr}>Score: +${rt(Yt(n,r,o,s))}</div>  </div>`),rr={finished:!1,order:Array(10).fill(0),tape:Array(10).fill(0),score:0,opacity:0},or=(t,e)=>u({display:t===0?"none":"block",position:"absolute",top:"10%",width:"100%",fontSize:`${e}px`,lineHeight:`${e}px`,textAlign:"center",color:"white",opacity:t,filter:"drop-shadow(0 0 0.3rem black)"}),F="min(4vw, 6vh)",sr=t=>u({marginBottom:F,fontSize:`calc(${F} * 1.3)`,color:t?"#fc9":"#c99"}),ct=E(4,6),lt=E(4,6),ir={display:"inline-block"};[ct,lt].forEach(t=>t.update(()=>({style:ir})));const ar=u({fontSize:F,marginTop:F}),dt=$(rr,t=>({finished:e,caseNumber:n,order:r,tape:o,score:s,opacity:a})=>(ct.update(()=>({tape:r})),lt.update(()=>({tape:o})),t`<div style=${or(a)}>    <div style=${sr(e)}>${e?"Finished!":"Game Over"}</div>    <div style=${`display:${e?"none":"block"}`}>${e?"":`at No.${n}`}</div>    ${e?"":ct.render()}<br>${e?"":lt.render()}<br>    <div style=${ar}>Total score: ${rt(s)}</div>  </div>`)),cr={opacity:0},lr=t=>u({display:t===0?"none":"block",position:"absolute",width:"100%",top:"30%",textAlign:"center",color:"white",opacity:t}),dr=u({fontSize:"min(12vw, 18vh)",color:"orange"}),B=$(cr,t=>({opacity:e})=>t`<div style=${lr(e)}>    <div style=${dr}>TMP</div>  </div>`);var d={title:{title:{}},main:{programWindowOpening:{},programming:{},programWindowClosing:{},running:{}},result:{caseResult:{},totalResult:{}}};const{now:pr}=g.globals,Vt=({startedAt:t})=>{const e=Math.max(T-(pr()-t)/1e3,0);C.update(()=>({timeLeft:e}))},ur=(t,e)=>{const n=e-t,r=n*qe;return Y<Math.abs(r)?t+r:t+Math.min(Math.max(-Y,n),Y)},L=({currentTape:t,position:e})=>{Ze(t),zt.update(({position:n})=>({position:ur(n,e)}))},te=(t,e)=>{const n=Math.max((1-t/20)*50,0),r=Math.min((1+t/20)*50,100),o=Math.min(Math.max((t-30)/10,0)*87+13,100),s=`polygon(${n}% 0, ${r}% 0, ${r}% ${o}%, ${n}% ${o}%)`;H.update(()=>({style:{clipPath:s},disabled:e}))},{now:fr,random:pt}=g.globals;var ee=(t=0,e=0)=>({currentTape:n,position:r,machineState:o})=>{if(t===0){const a=h();return Bt(a),C.update(()=>({number:1,timeLeft:T,score:0})),w.update(()=>({opacity:1})),{nextId:d.title.title,nextArgs:[1],stateUpdate:{position:0,machineState:0,order:a,currentTape:h()}}}if(L({currentTape:n,position:r}),b.update(()=>({state:o})),t<30)return B.update(()=>({opacity:t/30})),{nextId:d.title.title,nextArgs:[t+1]};if(t===30)return{nextId:d.title.title,nextArgs:[N()===m.goNext?31:30,(e+1)%V],stateUpdate:e===0?{currentTape:[...n.slice(0,r),Math.round(pt()),...n.slice(r+1,10)],position:{0:1,9:8}[r]||r+(pt()<.5?-1:1),machineState:Math.floor(pt()*5)}:{}};if(t<50){const a=(50-t)/20;return B.update(()=>({opacity:a})),w.update(()=>({opacity:a})),{nextId:d.title.title,nextArgs:[t+1]}}B.update(()=>({opacity:0})),w.update(()=>({opacity:0})),x.next(()=>I);const s=h();return{nextId:d.main.programWindowOpening,nextArgs:[0],stateUpdate:{caseNumber:1,score:0,order:h(),originalTape:s,currentTape:s,position:0,machinState:0,executedIndices:new Map,startedAt:fr()}}},$r=Object.defineProperty,mr=Object.prototype.hasOwnProperty,ne=Object.getOwnPropertySymbols,gr=Object.prototype.propertyIsEnumerable,re=(t,e,n)=>e in t?$r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oe=(t,e)=>{for(var n in e||(e={}))mr.call(e,n)&&re(t,n,e[n]);if(ne)for(var n of ne(e))gr.call(e,n)&&re(t,n,e[n]);return t};const{now:hr}=g.globals,se=(t,e,n)=>({type:t,time:0,accepted:e,timeLeft:n}),yr=(t,e)=>(t*6+e)/7|0,vr=t=>({executedIndices:e,steps:n,caseNumber:r,score:o})=>{const{time:s,type:a,accepted:l,timeLeft:c}=t;w.update(()=>({opacity:Math.min(s/10,1)})),D.update(()=>({opacity:Math.min(Math.max(0,(s-10)/30),1)})),s===0&&(D.update(()=>({type:a,commandsSaved:10-e.size,accepted:l,steps:n,timeLeft:c})),H.update(()=>({disabled:!0}))),C.update(({score:p})=>({score:s===40?o:yr(p,o)}));const i=N();if(s>=40&&i===m.goNext){if(D.update(()=>({opacity:0})),r===Tt)return{nextId:d.result.totalResult,nextArgs:[!0,0]};const p=r+1;C.update(()=>({number:p}));const f=h();return w.update(()=>({opacity:0})),x.next(()=>I),b.update(()=>({state:0})),{nextId:d.main.programWindowOpening,nextArgs:[0],stateUpdate:{caseNumber:p,order:h(),originalTape:f,currentTape:f,position:0,machineState:0,executedIndices:new Map,startedAt:hr()}}}return{nextId:d.result.caseResult,nextArgs:[oe(oe({},t),{time:s+1})],stateUpdate:s===0?{score:o+Yt(10-e.size,l,n,c)}:{}}},br=(t,e)=>({order:n,originalTape:r,score:o,caseNumber:s})=>{const a=N();return e<=40?(w.update(()=>({opacity:Math.min(e/10,1)})),dt.update(()=>({opacity:Math.max(0,(e-10)/30),finished:t,score:o,caseNumber:s,order:n,tape:r})),{nextId:d.result.totalResult,nextArgs:[t,e+1]}):e===41?{nextId:d.result.totalResult,nextArgs:[t,a===m.goNext?42:41]}:e<=61?(dt.update(()=>({opacity:(61-e)/20})),{nextId:d.result.totalResult,nextArgs:[t,e+1]}):{nextId:d.title.title,nextArgs:[0]}},{now:G}=g.globals,q=(t,e)=>Math.max(T-(t-e)/1e3,0),wr=t=>e=>{Bt(e.order);const n=t<Ct;return te(t,n),L(e),at.update(()=>({running:!1,disabled:n})),Vt(e),n?{nextId:d.main.programWindowOpening,nextArgs:[t+1]}:{nextId:d.main.programming,nextArgs:[]}},Sr=()=>t=>{L(t),Vt(t);const e=N();return e===m.run?(b.update(()=>({state:0})),{nextId:d.main.programWindowClosing,nextArgs:[Ct],stateUpdate:{currentTape:t.originalTape,machineState:0,position:0,runAt:G()}}):(e===m.reset&&x.next(()=>I),e===m.pass?{nextId:d.result.caseResult,nextArgs:[se(y.pass,!1,q(G(),t.startedAt))],stateUpdate:{steps:0}}:{nextId:d.main.programming,nextArgs:[],stateUpdate:e===m.reset?{currentTape:t.originalTape,machineState:0,position:0}:{}})},xr=t=>e=>(te(t,!0),L(e),at.update(()=>({running:t===0,disabled:t>0})),t===0?{nextId:d.main.running,nextArgs:[0],stateUpdate:{steps:0,executedIndices:new Set}}:{nextId:d.main.programWindowClosing,nextArgs:[t-1]});let ie=I;x.subscribe(t=>{ie=t});const _r=({currentTape:t,position:e,machineState:n,steps:r,executedIndices:o})=>{const s=n<<1|t[e],{direction:a,nextChar:l,nextState:c}=ie[s];return{currentTape:[...t.slice(0,e),l,...t.slice(e+1)],position:e+a,machineState:c,steps:r+1,executedIndices:new Set([...o,s])}},Or=t=>e=>{const{position:n,machineState:r,startedAt:o,runAt:s,order:a,currentTape:l}=e;if(N()===m.halt)return b.update(()=>({state:6})),q(G(),o)>0?{nextId:d.main.programWindowOpening,nextArgs:[0]}:{nextId:d.result.totalResult,nextArgs:[!1,0]};L(e);const c=n<0||n>=10?-1:r;if([-1,5].includes(c)&&t===V){if(b.update(()=>({state:c})),a.join``===l.join``){const i=q(s,o),p=i>0?y.solved:y.timeup;return{nextId:d.result.caseResult,nextArgs:[se(p,c===5,i)]}}return q(G(),o)>0?{nextId:d.main.programWindowOpening,nextArgs:[0],stateUpdate:{machineState:c}}:{nextId:d.result.totalResult,nextArgs:[!1,0]}}return b.update(()=>({state:r})),{nextId:d.main.running,nextArgs:[t===V?0:t+1],stateUpdate:t===0?_r(e):{}}};var Ar=Object.defineProperty,Pr=Object.prototype.hasOwnProperty,ae=Object.getOwnPropertySymbols,Tr=Object.prototype.propertyIsEnumerable,ce=(t,e,n)=>e in t?Ar(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,le=(t,e)=>{for(var n in e||(e={}))Pr.call(e,n)&&ce(t,n,e[n]);if(ae)for(var n of ae(e))Tr.call(e,n)&&ce(t,n,e[n]);return t};const{now:Er}=g.globals,Cr=new Map([[d.title.title,ee],[d.main.programWindowOpening,wr],[d.main.programming,Sr],[d.main.programWindowClosing,xr],[d.main.running,Or],[d.result.caseResult,vr],[d.result.totalResult,br]]),Ir=(t,e)=>({score:0,caseNumber:1,order:t,originalTape:e,currentTape:e,position:0,machineState:0,startedAt:Er(),runAt:null,steps:0,executedIndices:new Set}),de=(t,e)=>()=>{const{nextId:n,nextArgs:r,stateUpdate:o}=t(e);return de(Cr.get(n)(...r),le(le({},e),o))},{render:Mr,html:Nr}=g.uhtml;Mr(document.getElementById("root"),Nr`${[C,vn,zt,b,at,H,w,D,dt,B].map(t=>t.render())}`),Pt(de(ee(0),Ir(h(),h())),At)})();
